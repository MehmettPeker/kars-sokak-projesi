<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Kars Kültürel Sokak Projesi</title>
  <link rel="stylesheet" href="style.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>Kars Kültürel Sokak Projesi</h1>
      <p>Kars’ın sokak adlarına ilham olan kişiler — harita üzerinde keşfet, profilleri incele, QR ile paylaş.</p>
    </div>

    <div id="map" class="card"></div>

    <h2 style="margin:16px 0">Kişiler</h2>

    <input id="search" class="card"
      style="padding:12px;width:100%;margin:12px 0"
      type="search"
      placeholder="Ara: Atatürk, İnönü, Sokak, Cadde, Bulvar...">

    <div id="filters" style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
      <button class="btn filter active" data-type="all">Tümü (<span id="count-all">0</span>)</button>
      <button class="btn filter" data-type="cadde">Cadde (<span id="count-cadde">0</span>)</button>
      <button class="btn filter" data-type="sokak">Sokak (<span id="count-sokak">0</span>)</button>
      <button class="btn filter" data-type="bulvar">Bulvar (<span id="count-bulvar">0</span>)</button>

    </div>

    <div class="grid" id="peopleGrid"></div>

    <div class="footer">© 2025 Kars • Açık kaynak ve ücretsiz barındırma: GitHub Pages</div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // ✅ TEK KAYNAK
    const PLACES = [
      { name: "Vasfiye Eriş", type: "Caddesi", href: "kisiler/vasfiye-eris.html", lat: 40.59959, lng: 43.09199 },
      { name: "Haydar Aliyev", type: "Caddesi", href: "kisiler/haydar-aliyev.html", lat: 40.60398, lng: 43.09447 },
      { name: "Ahmet Arslan", type: "Caddesi", href: "kisiler/ahmet-arslan.html", lat: 40.605900, lng: 43.097500 },
      { name: "Ali Gaffar Okkan", type: "Bulvarı", href: "kisiler/ali-gaffar-okan.html", lat: 40.603800, lng: 43.092900 },
      { name: "Ali Rıza Bey", type: "Sokağı", href: "kisiler/ali-riza-bey.html", lat: 40.60276, lng: 43.09404 },
      { name: "Arif Taşçı", type: "Caddesi", href: "kisiler/arif-tasci.html", lat: 40.607800, lng: 43.101400 },
      { name: "Asım Ağçay", type: "Sokak", href: "kisiler/asim-agcay.html", lat: 40.606600, lng: 43.103200 },
      { name: "Teyyare", type: "Sokak", href: "kisiler/teyyare-sokak.html", lat: 40.605720, lng: 43.100860 },
      { name: "Alparslan Türkeş", type: "Bulvarı", href: "kisiler/alparslan-turkes.html", lat: 40.606000, lng: 43.098500 },
      { name: "Turan Çelebi", type: "Caddesi", href: "kisiler/turan-celebi.html", lat: 40.59813, lng: 43.09725 },
      { name: "Tuncer Güvensoy", type: "Caddesi", href: "kisiler/tuncer-guvensoy.html", lat: 40.60409, lng: 43.09293 },
      { name: "Buzhane", type: "Sokak", href: "kisiler/buzhane-sokak.html", lat: 40.60123, lng: 43.09201 },
      { name: "Kurban Ali Çelik", type: "Caddesi", href: "kisiler/kurban-ali-celik.html", lat: 40.61133, lng: 43.10186 },
      { name: "Selahattin Filtekin", type: "Caddesi", href: "kisiler/selahattin-filtekin.html", lat: 40.60654, lng: 43.09409 },
      { name: "Neşe Doster", type: "Sokak", href: "kisiler/nese-doster.html", lat: 40.60037, lng: 43.09129 },
      { name: "Şehit Hulisi Aytekin", type: "Caddesi", href: "kisiler/sehit-hulisi-aytekin.html", lat: 40.60706, lng: 43.08934 },
      { name: "Şehit Polis Sadullah Keleş", type: "Sokak", href: "kisiler/sehit-polis-sadullah-keles.html", lat: 40.59926, lng: 43.09253 },
      { name: "Şehit Polis Bülent Aktaş", type: "Sokak", href: "kisiler/sehit-polis-bulent-aktas.html", lat: 40.60172, lng: 43.11292 },
      { name: "Şehit Er Emin Polat", type: "Sokak", href: "kisiler/sehit-er-emin-polat.html", lat: 40.59684, lng: 43.09295 },
      { name: "Şehit Polis Tayfun Çele", type: "Sokak", href: "kisiler/sehit-polis-tayfun-cele.html", lat: 40.59841, lng: 43.08796 },

      // --- yeni 11 ---
      { name: "Atatürk", type: "Caddesi", href: "kisiler/ataturk.html", lat: 40.60564, lng: 43.09636 },
      { name: "Resul Yıldız", type: "Caddesi", href: "kisiler/resul-yildiz-caddesi.html", lat: 40.60067, lng: 43.09085 },
      { name: "Necati Bey", type: "Sokak", href: "kisiler/necati-bey-sokak.html", lat: 40.60266, lng: 43.10158 },
      { name: "Süleyman", type: "Sokak", href: "kisiler/suleyman-sokak.html", lat: 40.59913, lng: 43.08716 },
      { name: "Celal Aras", type: "Caddesi", href: "kisiler/celal-aras.html", lat: 40.61359, lng: 43.12347 },
      { name: "Gazi Ahmet Muhtar Paşa", type: "Caddesi", href: "kisiler/gazi-ahmet-muhtar-pasa.html", lat: 40.60488, lng: 43.09542 },
      { name: "İbrahim Kuytul", type: "Sokak", href: "kisiler/ibrahim-kuytul.html", lat: 40.595784, lng: 43.096280 },
      { name: "İsmail Hakkı Alaca", type: "Bulvarı", href: "kisiler/ismail-hakkı-alaca.html", lat: 40.59377, lng: 43.11882 },
      { name: "İsmet İnönü", type: "Caddesi", href: "kisiler/ismet-inonu.html", lat: 40.600906, lng: 43.096433 },
      { name: "Kazım Paşa", type: "Caddesi", href: "kisiler/kazim-pasa.html", lat: 40.60928, lng: 43.09428 },
      { name: "İbrahim Ethem Aykut", type: "Caddesi", href: "kisiler/ibrahim-ethem-aykut.html", lat: 40.59890, lng: 43.08741 },
      { name: "Hafız Kurban", type: "Sokağı", href: "kisiler/hafiz-kurban-sokak.html", lat: 40.60000, lng: 43.09500 }
      
    ];

    // ---- normalize + type normalize
    function normalizeTR(s) {
      return (s || "")
        .toString()
        .toLowerCase()
        .replaceAll("ı","i").replaceAll("İ","i")
        .replaceAll("ş","s").replaceAll("Ş","s")
        .replaceAll("ğ","g").replaceAll("Ğ","g")
        .replaceAll("ü","u").replaceAll("Ü","u")
        .replaceAll("ö","o").replaceAll("Ö","o")
        .replaceAll("ç","c").replaceAll("Ç","c");
    }

    function typeKey(typeText){
      const t = normalizeTR(typeText);
      if (t.includes("bulvar")) return "bulvar";
      if (t.includes("cadde")) return "cadde";
      // sokak / sokağı / sokagi hepsi sokak
      if (t.includes("sokak")) return "sokak";
      return "other";
    }

    // ✅ Harita
    const map = L.map('map').setView([40.6067, 43.0975], 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap katkıcıları'
    }).addTo(map);

    // ✅ Marker listesi (filtre için saklıyoruz)
    const markers = [];

    // ✅ Kartları + markerları üret
    const grid = document.getElementById("peopleGrid");

    PLACES.forEach(p => {
      const title = (p.name + " " + (p.type || "")).replace(/\s+/g, " ").trim();
      const key = typeKey(p.type || "");

      // --- Card
      const card = document.createElement("div");
      card.className = "card person";
      card.dataset.type = key;          // ✅ filtre buradan anlayacak
      card.dataset.search = normalizeTR(title);

      card.innerHTML = `
        <h3>${title}</h3>
        <p><a class="btn" href="${p.href}">Profili Gör</a></p>
      `;
      grid.appendChild(card);

      // --- Marker
      if (typeof p.lat === "number" && typeof p.lng === "number") {
        const m = L.marker([p.lat, p.lng]).addTo(map)
          .bindPopup(`<strong>${title}</strong><br/><a href='${p.href}'>Profili aç</a>`);
        markers.push({ marker: m, type: key, search: normalizeTR(title) });
      }
    });

    // ✅ Arama + Filtre (kart + marker beraber)
    let activeType = "all";
    let query = "";

    function applyFilters(){
      const cards = document.querySelectorAll(".person");

      cards.forEach(card => {
        const t = card.dataset.type;
        const s = card.dataset.search || "";
        const okType = (activeType === "all") ? true : (t === activeType);
        const okSearch = query ? s.includes(query) : true;
        card.style.display = (okType && okSearch) ? "" : "none";
      });

      markers.forEach(obj => {
        const okType = (activeType === "all") ? true : (obj.type === activeType);
        const okSearch = query ? obj.search.includes(query) : true;

        if (okType && okSearch) {
          if (!map.hasLayer(obj.marker)) obj.marker.addTo(map);
        } else {
          if (map.hasLayer(obj.marker)) map.removeLayer(obj.marker);
        }
      });
    }

    // Search
    const searchEl = document.getElementById("search");
    searchEl.addEventListener("input", (e) => {
      query = normalizeTR(e.target.value.trim());
      applyFilters();
    });

    // Filter buttons
    const filterBtns = document.querySelectorAll("#filters .filter");
    document.getElementById("filters").addEventListener("click", (e) => {
      const btn = e.target.closest("button.filter");
      if (!btn) return;

      activeType = (btn.dataset.type || "all").toLowerCase();

      filterBtns.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      applyFilters();
    });

    // initial
    applyFilters();
  </script>
  <script>
  function getTypeFromText(text){
    const t = normalizeTR(text);
    if (t.includes("bulvari")) return "bulvar";
    if (t.includes("caddesi") || t.includes("cadde")) return "cadde";
    if (t.includes("sokak") || t.includes("sokagi") || t.includes("sokağı")) return "sokak";
    return "other";
  }

  function updateCounts(){
    const visibleCards = Array.from(document.querySelectorAll('#peopleGrid .card'))
      .filter(c => c.style.display !== "none");

    let cadde=0, sokak=0, bulvar=0;
    visibleCards.forEach(card => {
      const type = getTypeFromText(card.innerText);
      if (type==="cadde") cadde++;
      if (type==="sokak") sokak++;
      if (type==="bulvar") bulvar++;
    });

    document.getElementById("count-all").textContent = visibleCards.length;
    document.getElementById("count-cadde").textContent = cadde;
    document.getElementById("count-sokak").textContent = sokak;
    document.getElementById("count-bulvar").textContent = bulvar;
  }

  // ilk yüklemede
  updateCounts();

  // arama sonrası da güncelle
  search.addEventListener('input', () => {
    updateCounts();
  });

  // filtreye basınca da güncelle (senin filtre kodunun sonunda çağır)
  filterButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      setTimeout(updateCounts, 0);
    });
  });
  </script>

</body>
</html>
